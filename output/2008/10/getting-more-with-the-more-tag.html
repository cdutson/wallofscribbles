<!DOCTYPE html>
<html lang="en">
<head>
        <title>Getting more with the MORE tag &#x2665; Wall Of Scribbles</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="This is me. I make digital things">
        <meta name="author" content="Corey Dutson">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link type="text/plain" rel="author" href="../../theme/humans.txt" />

        <script type='text/javascript' src='//code.jquery.com/jquery-1.11.3.min.js'></script>
            <script type='text/javascript' src='../../theme/webassets-external/d46a27c8e6574780133950f74c560b24_modernizr-min.js'></script>

        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <link href='http://fonts.googleapis.com/css?family=Merriweather:400,400italic|Varela+Round' rel='stylesheet' type='text/css'>
    
            <link rel="stylesheet" href="../../theme/webassets-external/67f3b7b5e7dee44893609921b80fd056_pygment.css">
            <link rel="stylesheet" href="../../theme/webassets-external/57dfd49ee87653ab4f71fe36c06150d1_s.css">
</head>

<body id="index" class="">

    <div id="pageWrap">

        <header id="header">
            <div class='site-title '><a class='pulse' href="../..">Wall Of Scribbles</a></div>
            <div class='site-tagline'>This is me. I make digital things.</div>
            <nav id="mainNavigation">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/archives.html">Writing</li>
                    <li><a href="/pages/portfolio.html">Portfolio</a></li>
                </ul>
            </nav>
        </header>
        <div id="sizeIcon">
            <span class="fa fa-desktop"></span>
            <span class="fa fa-laptop"></span>
            <span class="fa fa-tablet"></span>
            <span class="fa fa-mobile"></span>
        </div>
        <div id="contentWrapper">
<section id="singlePost">
<article id="post" class="content-article article ">
    <header>
        <h1 class="entry-title"><a href="../../2008/10/getting-more-with-the-more-tag.html" rel="bookmark" title="Permalink to Getting more with the MORE tag">Getting more with the MORE tag</a></h1>
        <div class="date-holder">Released <abbr class="published" title="2008-10-02T09:05:00-04:00"> October 02, 2008 </abbr>
            <a href="../../2008/10/getting-more-with-the-more-tag.html#disqus_thread" class="comment-count"><span class="disqus-comment-count" data-disqus-url="../../2008/10/getting-more-with-the-more-tag.html"></span></a>
        </div>
    </header>
    <section id="post-content">
        <p>So who out there uses Wordpress? I've been told it's <a href="http://publisherblog.automattic.com/2008/01/23/wordpress-most-popular-cms-in-technoratis-top-100/" title="Wordpress: Most popular CMS">somewhat
popular</a>.</p>
<p>I myself am a fan despite it's <a href="http://www.codinghorror.com/blog/archives/001105.html" title="Coding Horror: Behold Wordpress, destroyer of CPUs">assault on the CPU and
database</a>.
It's fast, it's simple, and so long as your website isn't gaining huge
traffic (or you're paying peanuts for CPU usage and storage) than it's a
great selection. It's fairly customizable, <a href="http://wordpress.org/extend/" title="Wordress: Extend">has a huge support and user
base</a>, and it's just
damned easy to use. I've been slowly getting more and more into
customizing and extending what Wordpress can do out of the box.There's
more in the code than people think.</p>
<p>Recently I <a href="http://bart.whahay.net" title="Bartek Gniado">a friend of mine</a>
ripped a strip off of me for only using summaries in my RSS feed. He
told me that he, along with other net-savvy users, didn't have time to
get teased by RSS summaries.</p>
<p><strong>UPDATE: As of December 3rd, 2008 I've turned this baby into a plugin!
~~Check it out.~~</strong></p>
<p><strong>UPDATE 2: Why my code was in a blockquote I will never, ever know.
I've updated the post to display as code. Thanks
<a href="#div-comment-1654" title="Pim in the comments">Pim</a>.</strong></p>
<p><strong>UPDATE 3: This is <a href="https://github.com/Corey%20Dutson/wp-post-divider" title="Github - Corey Dutson - wp-post-divider">up on
github</a>
now.</strong></p>
<!--more-->

<p><em>For those wishing to skip the lengthy buildup, here is a little table
of contents:</em></p>
<ul>
<li><a href="#solution_history" title="The Back story">The Back Story</a></li>
<li><a href="#solution" title="Solution">Solution</a></li>
<li><a href="#solution_explanation" title="Explanation">Explanation</a></li>
<li><a href="#solution_installation" title="Installation and Usage">Installation and
    Usage</a></li>
<li><a href="#solution_notes" title="Further Notes">Further Notes</a></li>
</ul>
<h3 id="solution_history">The Back Story - To Summarize or not to Summarize</h3>
<p>This is some what of a conundrum, as I want people to actually come to
my site. On the flip side, I want people to read what I write. So I can
force people to come to my site and gain page views, or I can increase
my RSS readership. After careful consideration, I've opted to fix my RSS
feed to display the entire content.</p>
<p>Here's the issue: Until now, I've used 'The Excerpt' field in Wordpress.
Basically this allows me to have a pretty excerpt instead of 55
characters truncated with a "READ MORE PLEAZE!" I use the custom excerpt
for the top part of the post; the preview if you will. The problem with
this is that I had to rip out the first couple paragraphs from the post
area, add some HTML to make sure it worked, and then post. The result
looked pretty, but had some unexpected side-effects on the RSS.</p>
<p>As it turns out, when you decide to use the EXCERPT field, that excerpt
will become the summary in the RSS. That's all well and good, but what
If you want to have the whole post? One would hope that it would stitch
the Excerpt and the Post together, but alas this was not the case.</p>
<p>I turned to the &lt;!--more--&gt; tag to assist me.</p>
<p>What they don't document about the more tag is pretty much all the
bitchy parts of it. When you use the &lt;!--more--&gt; tag, you split
the content, allowing for the excerpt to be defaulted to all the content
preceding the tag. This is great, except for how my layout works. You
see The top have is the Excerpt, and the bottom half is the rest of the
post. Just using the_content wouldn't work, because I would be
repeating all the pre-more content.</p>
<p>get_leader</p>
<p>I thought about maybe using an hr tag, or reworking my entire layout,
but I dismissed those due to the complexity of the markup. My only
option was to carve into Wordpress itself. I first checked Google to see
if anyone had come up against what I was facing. As it turns out <a href="http://wordpress.org/support/topic/184581" title="Wordpress: Support">people
have asked the
question</a>,
but no one has posted the answer.</p>
<p>I am fixing that right now.</p>
<h3 id="solution">Getting the Pre and Post &lt;!--more--&gt; content separately</h3>
<p>Here is my solution, in full:</p>
<p>[code language="php"]<br />
function the_formatted_pre_more_from_content (\$body)<br />
{<br />
\$returnVal = get_the_formatted_pre_more_from_content (\$body);<br />
if (\$returnVal !== FALSE)<br />
echo get_the_formatted_pre_more_from_content (\$body);<br />
else<br />
the_excerpt();<br />
}</p>
<p>function get_the_formatted_pre_more_from_content (\$body)<br />
{<br />
\$moreTag = '&lt;!--more';<br />
\$content = FALSE;</p>
<p>\$morePos = stripos(\$body, \$moreTag);<br />
if (\$morePos !== FALSE || \$morePos &gt; -1)<br />
\$content = substr(\$body, 0, \$morePos);<br />
else<br />
return FALSE;</p>
<p>\$content = apply_filters('the_content', \$content);<br />
\$content = str_replace(']]&gt;', ']]&gt;', \$content);</p>
<p>return \$content;<br />
}</p>
<p>function the_formatted_post_more_from_content (\$body)<br />
{<br />
echo get_the_formatted_post_more_from_content (\$body);<br />
}</p>
<p>function get_the_formatted_post_more_from_content (\$body)<br />
{<br />
\$moreTag = '&lt;!--more';<br />
\$content = FALSE;</p>
<p>\$morePos = stripos(\$body, \$moreTag);</p>
<p>if (\$morePos !== FALSE || \$morePos &gt; -1)<br />
{<br />
\$content = substr(\$body, \$morePos + strlen(\$moreTag));<br />
\$morePos = stripos(\$content, '--&gt;'); // reuse variable<br />
if (\$morePos !== FALSE || \$morePos &gt; -1)<br />
\$content = substr(\$content, \$morePos + 3); // strip off rest of more
tag<br />
}<br />
else<br />
\$content = \$body;</p>
<p>\$content = apply_filters('the_content', \$content);<br />
\$content = str_replace(']]&gt;', ']]&amp;gt;', \$content);</p>
<p>return \$content;<br />
}<br />
[/code]</p>
<h3 id="solution_explanation">Explanation</h3>
<p>The two important functions here are
'get_the_formatted_pre_more_from_content' and
'get_the_formatted_post_more_from_content'. Long names, I know,
but at least their mission is clear.</p>
<p>get_leader</p>
<p>The other two functions 'the_formatted_pre_more_from_content' and
'the_formatted_post_more_from_content' pretty much add a bit of
logic and echo the content automatically. I chose this naming structure
and function structure to emulate what is already in Wordpress (e.g.
'the_content' versus 'get_the_content').</p>
<h3 id="solution_installation">Installation and Usage</h3>
<p>To use this code, add it all to your functions.php file of your theme.
I'm sure I, or some other enterprising person, could turn this into a
plugin, but at the moment I don't feel it's warranted.</p>
<p>All of the functions take one parameter: <strong>\$body</strong>.</p>
<p>When you call these functions you must be in The Loop.</p>
<p><em><strong>example usage</strong>: &lt;?php
the_formatted_pre_more_from_content(\$post-&gt;post_content);
?&gt;</em></p>
<p><em><strong>explanation</strong>: This call will display the content preceding the
&lt;!--more--&gt; tag.</em></p>
<p><em><strong>example usage</strong>: &lt;?php
the_formatted_post_more_from_content(\$post-&gt;post_content);
?&gt;</em></p>
<p><em><strong>explanation</strong>: This call will display the content proceeding the
&lt;!--more--&gt; tag.</em></p>
<h3 id="solution_notes">Further Notes</h3>
<p><strong>UPDATE: As of December 3rd, 2008 I've turned this baby into a plugin!
<a href="/wordpress-plugins/postdivider/" title="Corey Dutson: PostDivider">Check it
out.</a> I've
also fixed the post_content bug!<br />
</strong></p>
<p>Note the <strong>\$post-&gt;post_content</strong> that is passed into the function.
This exists automatically when you are in The Loop. This will pass all
of the posts content to the function without any formatting. The only
thing that isn't straight text - conveniently - is the &lt;!--more--&gt;
tag. As a result the content becomes fairly straight forward.</p>
<p>As of right now you must pass \$post-&gt;post_content to the functions.
I tried to do it without passing the value, and they don't seem to pick
up the value.</p>
<p>I opted for using a substring functionality as opposed to an array split
function simply because it was 2 am when I finally got this going. I
don't know which is more efficient, so someone who is more knowledgeable
in PHP can comment on this and state which is better.</p>
<p>I only search for '&lt;!--more' because according to the tag
documentation, there is text that can follow the MORE that changes some
functionality. As a result, I have an additional if statement in the
get_post function that will detect for the end of the tag and substring
the content again to trim that out.</p>
<p>I hope that this helps out some people who may be in a similar boat as I
was.</p>
    </section>

    <footer class="post-info">
        <div class="meta">
            <p>
                <span title="tags" class="fa fa-tags"></span>
                    <a href="../../tag/code.html">Code</a>
,                     <a href="../../tag/development.html">development</a>
,                     <a href="../../tag/php.html">php</a>
,                     <a href="../../tag/wordpress.html">Wordpress</a>
            </p>
        </div>
    </footer>
        <section id="commentsHolder">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	    var disqus_shortname = 'wallofscribbles';
	    
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </section>
</article></section>
        </div>
    </div>
<footer id="footer">
    <div class="footer-stuff">
        <nav id="externalLinks">
            <h2>Where you can find me online</h2>
            <ul>
                <li><a href="http://www.twitter.com/cdutson"><i class="fa fa-twitter-square"></i><span>Twitter</span></a></li>
                <li><a href="http://dutsoninlondon.tumblr.com"><i  class="fa fa-tumblr-square"></i><span>Tumblr</span></a></li>
                <li><a href="http://www.flickr.com/photos/corey_dutson"><i class="fa fa-flickr"></i><span>Flickr</span></a></li>
                <li><a href="http://www.linkedin.com/in/coreydutson"><i class="fa fa-linkedin-square"></i><span>LinkedIn</span></a></li>
                <li><a href="https://github.com/cdutson"><i class="fa fa-github-square"></i><span>Github</span></a></li>
                <li><a href="http://steamcommunity.com/id/cdutson"><i class="fa fa-steam-square"></i><span>Steam</span></a></li>
                <li><a href="http://www.behance.net/coreydutson"><i class="fa fa-behance-square"></i><span>Behance</span></a></li>
            </ul>
        </nav>

        <nav id="extraLinks">
            <h2>I don't have icons for these links</h2>
            <ul>
                <li class="goodreads"><a href="http://www.goodreads.com/user/show/1198481">Goodreads</a></li>
                <li class="prints"><a href="http://printsbydutson.com">Prints by Dutson</a></li>
            </ul>
        </nav>
        
        <p class="copy">© Corey Dutson, 2015.<br/>Built using <a href="http://getpelican.com/">Pelican</a></p>
    </div>
</footer>        <script type='text/javascript' src='../../theme/webassets-external/a05a980c28bd2e3b9a3625b2af67b711_plugins.js'></script>
        <script type='text/javascript' src='../../theme/webassets-external/4ca0b55487c0d704be1c035e83f89932_general.js'></script>
    <script>
        $(document).ready(function() {
            WOS.UI.init();
    
        });
    </script>
    <script type="text/javascript">
        var disqus_shortname = 'wallofscribbles'; // required: replace example with your forum shortname

        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>