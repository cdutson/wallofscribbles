<!DOCTYPE html>
<html lang="en">
<head>
        <title>Cannot insert the value NULL into column Name, Thanks SharePoint &#x2665; Wall Of Scribbles</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="This is me. I make digital things">
        <meta name="author" content="Corey Dutson">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <link type="text/plain" rel="author" href="../../theme/humans.txt" />

        <script type='text/javascript' src='//code.jquery.com/jquery-1.11.3.min.js'></script>
            <script type='text/javascript' src='../../theme/webassets-external/d46a27c8e6574780133950f74c560b24_modernizr-min.js'></script>

        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
        <link href='http://fonts.googleapis.com/css?family=Merriweather:400,400italic|Varela+Round' rel='stylesheet' type='text/css'>
    
            <link rel="stylesheet" href="../../theme/webassets-external/67f3b7b5e7dee44893609921b80fd056_pygment.css">
            <link rel="stylesheet" href="../../theme/webassets-external/57dfd49ee87653ab4f71fe36c06150d1_s.css">
</head>

<body id="index" class="">

    <div id="pageWrap">

        <header id="header">
            <div class='site-title '><a class='pulse' href="../..">Wall Of Scribbles</a></div>
            <div class='site-tagline'>This is me. I make digital things.</div>
            <nav id="mainNavigation">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/archives.html">Writing</li>
                    <li><a href="/pages/portfolio.html">Portfolio</a></li>
                </ul>
            </nav>
        </header>
        <div id="sizeIcon">
            <span class="fa fa-desktop"></span>
            <span class="fa fa-laptop"></span>
            <span class="fa fa-tablet"></span>
            <span class="fa fa-mobile"></span>
        </div>
        <div id="contentWrapper">
<section id="singlePost">
<article id="post" class="content-article article ">
    <header>
        <h1 class="entry-title"><a href="../../2008/03/thanks-sharepoint.html" rel="bookmark" title="Permalink to Cannot insert the value NULL into column Name, Thanks SharePoint">Cannot insert the value NULL into column Name, Thanks SharePoint</a></h1>
        <div class="date-holder">Released <abbr class="published" title="2008-03-07T00:05:00-05:00"> March 07, 2008 </abbr>
            <a href="../../2008/03/thanks-sharepoint.html#disqus_thread" class="comment-count"><span class="disqus-comment-count" data-disqus-url="../../2008/03/thanks-sharepoint.html"></span></a>
        </div>
    </header>
    <section id="post-content">
        <p>My feature code was throwing an error today. For those who don't know
what I'm talking about here is a crash course: A feature basically
allows you to attach functionality to something in SharePoint. Maybe you
want to add a menu option to the 'Site Actions' menu, or import some
files into libraries. In my case I wanted to attach functionality to a
specific list. I wrote my feature code, and it seemed fine. Deployed and
activated just great.</p>
<p>Then I tried to create a Custom List. I had event receivers attached to
custom lists (ListTemplateID=100 for those who care) and i got this:</p>
<p><em>Cannot insert the value NULL into column 'Name', table
'[somesharepointcontentdatabase].dbo.EventReceivers';<br />
column does not allow nulls. INSERT fails.<br />
The statement has been terminated.</em></p>
<p>Took me a good two hours of trying everything I could think of with my
XML and code, only to be repeatedly thwarted by this database-level
error! I tried commenting out different sections of my receivers and
still got the error. When I commented the entire <span
style="color: blue">&lt;</span><span
style="color: red">Receivers</span><span style="color: blue">&gt;</span>
section, things ran fine, but not the <span
style="color: blue">&lt;</span><span
style="color: red">Receiver</span><span
style="color: blue">&gt;</span>items inside. What the hell is going on?
Read on!</p>
<p>get_leader</p>
<p>I'll give an example of what I'm talking about here - the following
comes from
<a href="http://msdn2.microsoft.com/en-us/library/ms460929.aspx" title="MSDN: Event Registrations">MSDN</a>:</p>
<p><strong>feature.xml</strong>:<br />
<span style="color: blue">&lt;</span><span
style="color: red">Feature</span><br />
Scope="Web"<br />
Title="Simple Updating Item Event Handler Registration"<br />
Id="A6B8687A-3200-4b01-AD76-09E8D163FB9A"<br />
xmlns="http://schemas.microsoft.com/sharepoint/"<span
style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">ElementManifests</span><span
style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">ElementManifest</span> Location="elements.xml"<span
style="color: blue">/&gt;</span><br />
<span style="color: blue">&lt;/</span><span
style="color: red">ElementManifests</span><span
style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;/</span><span
style="color: red">Feature</span><span style="color: blue">&gt;</span></p>
<p><em>inside the feature.xml file (above) it references the following file:</em></p>
<p><strong>elements.xml</strong>:</p>
<p><span style="color: blue">&lt;</span><span
style="color: red">Elements</span>
xmlns="http://schemas.microsoft.com/sharepoint/"<span
style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Receivers</span><br />
ListTemplateOwner="ADDABAAA-1111-2222-3333-111111111111"<br />
ListTemplateId="104"<span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Receiver</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Name</span><span
style="color: blue">&gt;</span>SimpleUpdateEvent<span
style="color: blue">&lt;/</span><span
style="color: red">Name</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Type</span><span
style="color: blue">&gt;</span>ItemUpdating<span
style="color: blue">&lt;/</span><span
style="color: red">Type</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">SequenceNumber</span><span
style="color: blue">&gt;</span>10000<span
style="color: blue">&lt;/</span><span
style="color: red">SequenceNumber</span><span
style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Assembly</span><span
style="color: blue">&gt;</span>SimpleUpdateEventHandler,
Version=1.0.0.0, Culture=neutral, PublicKeyToken=10b23036c9b36d6d<span
style="color: blue">&lt;/</span><span
style="color: red">Assembly</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Class</span><span
style="color: blue">&gt;</span>MS.Samples.SimpleItemUpdateHandler<span
style="color: blue">&lt;/</span><span
style="color: red">Class</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Data</span><span
style="color: blue">&gt;&lt;/</span><span
style="color: red">Data</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;</span><span
style="color: red">Filter</span><span
style="color: blue">&gt;&lt;/</span><span
style="color: red">Filter</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;/</span><span
style="color: red">Receiver</span><span style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;/</span><span
style="color: red">Receivers</span><span
style="color: blue">&gt;</span><br />
<span style="color: blue">&lt;/</span><span
style="color: red">Elements</span><span style="color: blue">&gt;</span></p>
<p>This works fine. Here's something interesting though: any comments -
<font color="#0000ff">&lt;</font>!-- <font color="#008000">Like
this</font> --<font color="#0000ff">&gt; </font>- you have in the <span
style="color: blue">&lt;</span><span
style="color: red">Receivers</span><span style="color: blue">&gt;</span>
node will be literally interpreted as <span
style="color: blue">&lt;</span><span
style="color: red">Receiver</span><span style="color: blue">&gt;</span>
nodes! That means whenever it tries to attach event receivers to any
list, it treats the comments as actual receivers! That's right, for
whatever reason, the code that ties event receivers to lists literally
loops through every node (comments are still considered nodes!) and
tries to use them instead of using any sort of
<a href="http://en.wikipedia.org/wiki/XPath" title="Wikipedia: XPath">XPath</a>. How hard
is it to use "//Elements/Receivers/Receiver" as your node collection
XPath? I really hope whoever wrote that code got the ruler or something.</p>
<h3>The solution: Remove comments from your Feature xml file(s).</h3>
<p>I say this because God only knows where else this is happening, and the
odds of you realizing that it is something that should just work, like
comments, are probably not that high. Remember folks, sometimes the most
obtuse problems have the most simple answers. Try not to over-think
things.</p>
<p>A huge thank you must go out to <a href="http://blogs.msdn.com/jannemattila/" title="Janne Mattila">Janne
Mattila</a> for being
the first (and apparently only according to Google) <a href="http://blogs.msdn.com/jannemattila/archive/2007/02/08/moss-and-eventhandler-deployment-with-features-cannot-insert-the-value-null-into-column.aspx" title="Janne Mattila: MOSS and EventHandler deployment with features + Cannot insert the value NULL into column...">documenting
this</a>.
I wish I had looked sooner.</p>
    </section>

    <footer class="post-info">
        <div class="meta">
            <p>
                <span title="tags" class="fa fa-tags"></span>
                    <a href="../../tag/design.html">Design</a>
,                     <a href="../../tag/good-practices.html">good-practices</a>
,                     <a href="../../tag/internet.html">Internet</a>
,                     <a href="../../tag/microsoft.html">Microsoft</a>
,                     <a href="../../tag/moss.html">MOSS</a>
,                     <a href="../../tag/sharepoint.html">SharePoint</a>
,                     <a href="../../tag/xml.html">xml</a>
            </p>
        </div>
    </footer>
        <section id="commentsHolder">
	<div id="disqus_thread"></div>
	<script type="text/javascript">
	    var disqus_shortname = 'wallofscribbles';
	    
	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();
	</script>
	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </section>
</article></section>
        </div>
    </div>
<footer id="footer">
    <div class="footer-stuff">
        <nav id="externalLinks">
            <h2>Where you can find me online</h2>
            <ul>
                <li><a href="http://www.twitter.com/cdutson"><i class="fa fa-twitter-square"></i><span>Twitter</span></a></li>
                <li><a href="http://dutsoninlondon.tumblr.com"><i  class="fa fa-tumblr-square"></i><span>Tumblr</span></a></li>
                <li><a href="http://www.flickr.com/photos/corey_dutson"><i class="fa fa-flickr"></i><span>Flickr</span></a></li>
                <li><a href="http://www.linkedin.com/in/coreydutson"><i class="fa fa-linkedin-square"></i><span>LinkedIn</span></a></li>
                <li><a href="https://github.com/cdutson"><i class="fa fa-github-square"></i><span>Github</span></a></li>
                <li><a href="http://steamcommunity.com/id/cdutson"><i class="fa fa-steam-square"></i><span>Steam</span></a></li>
                <li><a href="http://www.behance.net/coreydutson"><i class="fa fa-behance-square"></i><span>Behance</span></a></li>
            </ul>
        </nav>

        <nav id="extraLinks">
            <h2>I don't have icons for these links</h2>
            <ul>
                <li class="goodreads"><a href="http://www.goodreads.com/user/show/1198481">Goodreads</a></li>
                <li class="prints"><a href="http://printsbydutson.com">Prints by Dutson</a></li>
            </ul>
        </nav>
        
        <p class="copy">© Corey Dutson, 2015.<br/>Built using <a href="http://getpelican.com/">Pelican</a></p>
    </div>
</footer>        <script type='text/javascript' src='../../theme/webassets-external/a05a980c28bd2e3b9a3625b2af67b711_plugins.js'></script>
        <script type='text/javascript' src='../../theme/webassets-external/4ca0b55487c0d704be1c035e83f89932_general.js'></script>
    <script>
        $(document).ready(function() {
            WOS.UI.init();
    
        });
    </script>
    <script type="text/javascript">
        var disqus_shortname = 'wallofscribbles'; // required: replace example with your forum shortname

        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>